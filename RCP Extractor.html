<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCP Extractor - Cats Rule The World</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;800&family=JetBrains+Mono:wght@400;800&family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* --- THEME: NEON GOD --- */
            --void-bg: #020205;
            --neon-cyan: #00f3ff;
            --neon-magenta: #ff0099;
            --neon-purple: #bc13fe;
            --neon-lime: #ccff00;
            --glass-panel: rgba(10, 10, 20, 0.9);
            --glass-border: rgba(0, 243, 255, 0.3);
            
            /* --- NYAN PALETTE --- */
            --nyan-grey: #999999;
            --nyan-tart: #ffcc99;
            --nyan-pink: #ff99ff;
            --nyan-red: #ff0000;
            --nyan-cheek: #ff9999;
            
            --font-ui: 'Rajdhani', sans-serif;
            --font-pixel: 'Press Start 2P', cursive;
            --font-code: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; outline: none; user-select: none; }

        body {
            margin: 0; height: 100vh; width: 100vw;
            background: radial-gradient(ellipse at center, #150025 0%, #050510 60%, #000000 100%);
            color: #fff;
            font-family: var(--font-ui); 
            overflow: hidden; 
            display: flex; justify-content: center; align-items: center; 
            perspective: 1500px;
        }

        /* 1. NEON STAR ENGINE */
        #warpCanvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -20;
        }

        /* 2. SWARM LAYER */
        #swarmLayer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -10; pointer-events: none;
            transform-style: preserve-3d;
        }
        .flying-nyan {
            position: absolute; top: 50%; left: 50%;
            transform-style: preserve-3d; will-change: transform;
        }

        /* 3. LAYOUT WRAPPERS (ANIMATION ISOLATION) */
        #shake-layout {
            display: flex; justify-content: center; align-items: center;
            width: 100%; height: 100%;
            pointer-events: none; /* Pass clicks to UI */
        }

        /* UI FRAME */
        .holo-interface {
            width: 95%; max-width: 1200px; height: 85vh; max-height: 850px;
            background: var(--glass-panel);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            box-shadow: 
                0 0 100px rgba(0, 243, 255, 0.05),
                0 20px 50px rgba(0,0,0,0.8),
                inset 0 0 100px rgba(0,0,0,0.6);
            display: flex; flex-direction: column;
            position: relative; z-index: 10;
            pointer-events: auto;
            transform-origin: center center;
            transition: transform 0.1s;
        }

        /* --- ANIMATIONS --- */
        
        /* 1. RUMBLE LOOP (New! ‡∏™‡∏±‡πà‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡∏ï‡∏≠‡∏ô‡∏•‡∏≤‡∏Å) */
        .effect-rumble {
            animation: rumbleLoop 0.1s linear infinite;
        }
        @keyframes rumbleLoop {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-2px, 1px) rotate(-0.3deg); }
            50% { transform: translate(1px, -2px) rotate(0.3deg); }
            75% { transform: translate(-1px, -1px) rotate(-0.3deg); }
            100% { transform: translate(2px, 1px) rotate(0.3deg); }
        }

        /* 2. IMPACT SHAKE (‡∏™‡∏±‡πà‡∏ô‡πÅ‡∏£‡∏á‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢) */
        .effect-shake {
            animation: shakeHard 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shakeHard {
            10%, 90% { transform: translate3d(-5px, 0, 0); }
            20%, 80% { transform: translate3d(10px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-10px, 0, 0); }
            40%, 60% { transform: translate3d(10px, 0, 0); }
        }

        /* 3. SUCTION (‡∏î‡∏π‡∏î‡∏ß‡∏π‡∏ö) */
        .effect-suction {
            animation: suctionWarp 0.4s ease-in-out forwards;
        }
        @keyframes suctionWarp {
            0% { transform: scale(1); filter: brightness(1); }
            40% { transform: scale(0.9) translateZ(-100px); filter: brightness(1.5); }
            100% { transform: scale(1); filter: brightness(1); }
        }

        /* RGB Border */
        .holo-interface::before {
            content: ''; position: absolute; inset: -2px; z-index: -1;
            background: linear-gradient(180deg, var(--neon-cyan), transparent 20%, transparent 80%, var(--neon-magenta));
            border-radius: 24px; opacity: 0.8;
            filter: blur(2px);
            animation: borderBreath 4s infinite alternate;
        }
        @keyframes borderBreath { from { opacity: 0.5; filter: blur(2px); } to { opacity: 1; filter: blur(5px); } }

        /* HEADER */
        header {
            padding: 25px 40px; display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.2); border-radius: 24px 24px 0 0;
            position: relative; overflow: hidden;
        }
        header::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(90deg, #f00, #ff9900, #ff0, #3f0, #09f, #63f, #f00);
            background-size: 200% 100%; animation: rainbowSlide 2s linear infinite;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        @keyframes rainbowSlide { 0% { background-position: 0 0; } 100% { background-position: 200% 0; } }

        .brand h1 { 
            margin: 0; font-size: 2.5rem; font-weight: 800; letter-spacing: 3px;
            color: #fff; text-transform: uppercase; position: relative;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
        }
        .brand h1::before, .brand h1::after {
            content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.8;
        }
        .brand h1::before { color: #0ff; z-index: -1; animation: glitch-1 2.5s infinite linear alternate-reverse; }
        .brand h1::after { color: #f0f; z-index: -2; animation: glitch-2 3s infinite linear alternate-reverse; }
        @keyframes glitch-1 { 0% { clip: rect(30px, 999px, 10px, 0); transform: translate(-2px,0); } 100% { clip: rect(10px, 999px, 80px, 0); transform: translate(1px,0); } }
        @keyframes glitch-2 { 0% { clip: rect(10px, 999px, 90px, 0); transform: translate(2px,0); } 100% { clip: rect(40px, 999px, 70px, 0); transform: translate(-1px,0); } }

        .brand span { font-family: var(--font-pixel); font-size: 0.7rem; color: var(--neon-magenta); margin-left: 5px; letter-spacing: 1px; }

        .toggle-switch {
            display: flex; align-items: center; gap: 12px; cursor: pointer;
            padding: 8px 16px; border: 1px solid rgba(255,255,255,0.1); border-radius: 50px;
            background: rgba(0,0,0,0.3); transition: 0.3s;
        }
        .toggle-switch:hover { border-color: var(--neon-cyan); box-shadow: 0 0 15px rgba(0, 243, 255, 0.3); }
        .toggle-switch.active { background: rgba(0, 243, 255, 0.1); border-color: var(--neon-cyan); }
        .t-dot { width: 10px; height: 10px; background: #666; border-radius: 50%; transition: 0.3s; }
        .toggle-switch.active .t-dot { background: var(--neon-cyan); box-shadow: 0 0 10px var(--neon-cyan); }

        /* WORKSPACE */
        .workspace { flex: 1; padding: 40px; display: flex; gap: 40px; overflow: hidden; position: relative; }

        /* DROP PORTAL */
        .drop-portal {
            flex: 1; position: relative;
            border: 2px dashed rgba(0, 243, 255, 0.3); border-radius: 20px;
            background: radial-gradient(circle at center, rgba(0, 243, 255, 0.05) 0%, rgba(20, 10, 40, 0.6) 100%);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5), inset 0 0 50px rgba(0, 243, 255, 0.02);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            overflow: hidden;
            animation: portalPulse 3s infinite alternate;
        }
        @keyframes portalPulse {
            0% { border-color: rgba(0, 243, 255, 0.3); box-shadow: inset 0 0 20px rgba(0, 243, 255, 0.05); }
            100% { border-color: rgba(188, 19, 254, 0.5); box-shadow: inset 0 0 50px rgba(188, 19, 254, 0.1); }
        }

        .drop-portal.drag-active {
            border-color: var(--neon-cyan); 
            background: radial-gradient(circle at center, rgba(0, 243, 255, 0.2), #000);
            box-shadow: 0 0 80px rgba(0, 243, 255, 0.5), inset 0 0 100px rgba(0, 243, 255, 0.3);
            transform: scale(0.96);
            animation: none;
        }
        .drop-portal.drag-active .nyan-unit {
            animation: hyperSpin 0.3s linear infinite !important;
            filter: drop-shadow(0 0 30px var(--neon-cyan));
            transform: scale(1.3); 
        }
        @keyframes hyperSpin { 0% { transform: rotate(0deg) scale(1.3); } 100% { transform: rotate(360deg) scale(1.3); } }

        /* NYAN CAT (PIXEL PERFECT) */
        .nyan-unit { position: relative; width: 150px; height: 100px; animation: float 3s ease-in-out infinite; transition: 0.3s; }
        .nyan-scale { transform: scale(4); position: absolute; top: 50%; left: 50%; }
        .n-rainbow { position: absolute; top: -6px; left: -40px; width: 44px; height: 18px; background: linear-gradient(to bottom, #f00 16%, #ff9900 32%, #ff0 48%, #3f0 64%, #09f 80%, #63f 100%); animation: rainbowMove 0.4s steps(2) infinite; }
        @keyframes rainbowMove { 0% { left: -40px; } 100% { left: -44px; } }
        .n-tail { position: absolute; top: 0; left: -14px; width: 15px; height: 12px; animation: tailWag 0.4s steps(4) infinite; }
        .n-tail::before { content: ''; position: absolute; width: 1px; height: 1px; box-shadow: 2px 3px #000, 3px 3px #000, 4px 3px #000, 1px 4px #000, 2px 4px #999, 3px 4px #999, 4px 4px #999, 5px 4px #000, 0px 5px #000, 1px 5px #999, 2px 5px #999, 3px 5px #999, 4px 5px #999, 5px 5px #000, 0px 6px #000, 1px 6px #999, 2px 6px #999, 3px 6px #999, 4px 6px #999, 5px 6px #000, 1px 7px #000, 2px 7px #999, 3px 7px #999, 4px 7px #000, 5px 7px #000; }
        @keyframes tailWag { 0% { transform: translateX(0); } 50% { transform: translateX(-2px); } 100% { transform: translateX(0); } }
        .n-body { position: absolute; top: -10px; left: -10px; width: 22px; height: 15px; background: #ffcc99; border: 1px solid #000; }
        .n-body-pink { position: absolute; top: 1px; left: 1px; width: 18px; height: 11px; background: #ff99ff; }
        .n-sprinkles::after { content: ''; position: absolute; width: 1px; height: 1px; color: #f00; box-shadow: 3px 2px, 8px 3px, 12px 1px, 4px 8px, 9px 7px, 14px 9px; }
        .n-head { position: absolute; top: -5px; left: 6px; width: 16px; height: 10px; background: #999; border: 1px solid #000; z-index: 5; }
        .n-head::before { content: ''; position: absolute; top: -3px; left: 0; width: 1px; height: 1px; color: #999; border-left: 1px solid #000; border-right: 1px solid #000; border-top: 1px solid #000; box-shadow: 1px 1px, 12px 0 0 0 #999, 12px 0 0 -1px #000; }
        .n-face::after { content: ''; position: absolute; width: 1px; height: 1px; box-shadow: 2px 2px #000, 3px 2px #000, 9px 2px #000, 10px 2px #000, 6px 3px #000, 1px 4px #ff9999, 2px 4px #ff9999, 10px 4px #ff9999, 11px 4px #ff9999; }
        .n-legs { position: absolute; bottom: -12px; left: -10px; width: 25px; height: 5px; animation: run 0.2s steps(4) infinite; }
        .n-legs::before { content: ''; position: absolute; width: 1px; height: 1px; color: #999; border: 1px solid #000; box-shadow: 1px 0, 3px 0 #000, 4px 0, 15px 0 #000, 16px 0, 19px 0 #000, 20px 0; }
        @keyframes run { 0% { transform: translateX(0); } 50% { transform: translateX(-1px); } 100% { transform: translateX(0); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .drop-hint { margin-top: 40px; text-align: center; }
        .drop-hint h3 { font-size: 1.5rem; letter-spacing: 2px; }
        .drop-hint p { font-family: var(--font-pixel); color: var(--neon-cyan); font-size: 0.6rem; margin-top: 10px; }

        /* DATA LIST */
        .data-list { flex: 0; width: 0; opacity: 0; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; overflow-y: auto; padding: 0; transition: 0.4s ease; }
        .workspace.active .drop-portal { flex: 0 0 350px; }
        .workspace.active .data-list { flex: 1; width: auto; opacity: 1; padding: 20px; border-color: var(--neon-cyan); }
        .file-item { display: flex; align-items: center; justify-content: space-between; padding: 12px; margin-bottom: 8px; background: rgba(255,255,255,0.05); border-radius: 6px; border-left: 3px solid transparent; }
        .file-item:hover { background: rgba(0, 243, 255, 0.1); border-left-color: var(--neon-cyan); }
        .f-name { font-family: var(--font-code); font-size: 0.85rem; }

        /* FOOTER */
        .control-bar { padding: 25px 40px; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(255,255,255,0.1); border-radius: 0 0 24px 24px; display: flex; justify-content: space-between; align-items: center; }
        .status { font-family: var(--font-code); color: #888; font-size: 0.8rem; display: flex; align-items: center; gap: 8px; }
        .dot { width: 8px; height: 8px; background: #444; border-radius: 50%; }
        .status.ready { color: var(--neon-cyan); }
        .status.ready .dot { background: #0f0; box-shadow: 0 0 10px #0f0; }
        .btn-group { display: flex; gap: 15px; }
        .btn { border: none; padding: 14px 28px; font-family: var(--font-ui); font-weight: 700; font-size: 1rem; text-transform: uppercase; cursor: pointer; border-radius: 6px; letter-spacing: 1px; transition: 0.2s; }
        .btn-clear { background: rgba(255, 50, 50, 0.1); color: #ff5555; border: 1px solid rgba(255, 50, 50, 0.3); }
        .btn-clear:hover { background: rgba(255, 50, 50, 0.3); box-shadow: 0 0 15px rgba(255, 0, 0, 0.4); }
        .btn-warp { background: var(--neon-cyan); color: #000; box-shadow: 0 0 20px rgba(0, 243, 255, 0.4); clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%); }
        .btn-warp:hover { transform: translateY(-2px); background: #fff; box-shadow: 0 0 40px rgba(0, 243, 255, 0.8); }

        #hiddenOutput { position: absolute; opacity: 0; pointer-events: none; }
        .particle { position: absolute; width: 6px; height: 6px; background: var(--neon-cyan); border-radius: 50%; pointer-events: none; z-index: 100; box-shadow: 0 0 10px var(--neon-cyan); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--neon-cyan); border-radius: 3px; }
    </style>
</head>
<body>

    <canvas id="warpCanvas"></canvas>
    <div id="swarmLayer"></div>

    <div id="shake-layout">
        <div class="holo-interface" id="mainUI">
            <header>
                <div class="brand">
                    <h1 data-text="RCP Extractor">RCP Extractor</h1>
                    <span>Cats Rule The World</span>
                </div>
                <div class="toggle-switch" id="extToggle" onclick="toggleExt()">
                    <div class="t-dot"></div>
                    <span style="font-size: 0.8rem; font-weight: 700;">KEEP .MP4</span>
                </div>
            </header>

            <div class="workspace" id="workspace">
                <div class="drop-portal" id="dropZone">
                    <div class="nyan-unit">
                        <div class="nyan-scale">
                            <div class="n-rainbow"></div><div class="n-tail"></div><div class="n-legs"></div>
                            <div class="n-body"><div class="n-body-pink"><div class="n-sprinkles"></div></div></div>
                            <div class="n-head"><div class="n-ear-l"></div><div class="n-ear-r"></div><div class="n-face"></div></div>
                        </div>
                    </div>
                    <div class="drop-hint">
                        <h3>DROP FILES HERE</h3>
                        <p>FEED THE VOID</p>
                    </div>
                    <input type="file" id="fileInput" multiple style="display:none">
                </div>

                <div class="data-list">
                    <div id="fileListDisplay"></div>
                </div>
            </div>

            <div class="control-bar">
                <div class="status" id="statusDisplay"><div class="dot"></div>WAITING FOR DATA...</div>
                <div class="btn-group">
                    <button class="btn btn-clear" onclick="clearText()">NUKE</button>
                    <button class="btn btn-warp" id="copyBtn" onclick="copyText()">COPY & WARP</button>
                </div>
            </div>
            <textarea id="hiddenOutput"></textarea>
        </div>
    </div>

<script>
    /* =========================================
       1. NEON STAR ENGINE
       ========================================= */
    const canvas = document.getElementById('warpCanvas');
    const ctx = canvas.getContext('2d');
    let width, height, stars = [];
    let warpSpeed = 1;
    let targetWarpSpeed = 1;

    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
    }
    window.addEventListener('resize', resize);
    resize();

    class Star {
        constructor() {
            this.x = Math.random() * width - width / 2;
            this.y = Math.random() * height - height / 2;
            this.z = Math.random() * width; 
            this.pz = this.z;
            this.color = ['#00f3ff', '#bc13fe', '#ccff00', '#ffffff', '#ff0099'][Math.floor(Math.random() * 5)];
            this.blinkSpeed = Math.random() * 0.05 + 0.02;
            this.blinkOffset = Math.random() * 100;
        }
        update() {
            this.z -= warpSpeed;
            if (this.z < 1) {
                this.z = width;
                this.x = Math.random() * width - width / 2;
                this.y = Math.random() * height - height / 2;
                this.pz = this.z;
            }
        }
        draw() {
            const sx = (this.x / this.z) * width/2 + width / 2;
            const sy = (this.y / this.z) * height/2 + height / 2;
            const px = (this.x / this.pz) * width/2 + width / 2;
            const py = (this.y / this.pz) * height/2 + height / 2;
            this.pz = this.z;

            const r = (1 - this.z / width);
            const twinkle = Math.sin((Date.now() / 200) + this.blinkOffset) * 0.5 + 0.5;
            const alpha = warpSpeed > 10 ? 1 : 0.3 + (twinkle * 0.7); 

            ctx.beginPath();
            ctx.moveTo(px, py);
            ctx.lineTo(sx, sy);
            ctx.strokeStyle = this.color;
            ctx.globalAlpha = alpha;
            
            if (warpSpeed > 10) {
                ctx.lineWidth = r * 3; ctx.shadowBlur = 0; 
            } else {
                ctx.lineWidth = r * 3; ctx.shadowColor = this.color; ctx.shadowBlur = 10;
            }
            ctx.stroke();
            ctx.shadowBlur = 0; ctx.globalAlpha = 1;
        }
    }

    for (let i = 0; i < 600; i++) stars.push(new Star());

    function animateWarp() {
        ctx.fillStyle = 'rgba(2, 2, 5, 0.4)'; 
        ctx.fillRect(0, 0, width, height);
        warpSpeed += (targetWarpSpeed - warpSpeed) * 0.05;
        stars.forEach(s => { s.update(); s.draw(); });
        requestAnimationFrame(animateWarp);
    }
    animateWarp();

    /* =========================================
       2. SWARM LOGIC (CHAOS MODE)
       ========================================= */
    const swarmLayer = document.getElementById('swarmLayer');
    function createMiniNyan() {
        const wrap = document.createElement('div');
        wrap.className = 'flying-nyan';
        wrap.innerHTML = `
            <div class="nyan-unit" style="transform: scale(0.6);">
                <div class="nyan-scale">
                    <div class="n-rainbow"></div><div class="n-tail"></div><div class="n-legs"></div>
                    <div class="n-body"><div class="n-body-pink"><div class="n-sprinkles"></div></div></div>
                    <div class="n-head"><div class="n-ear-l"></div><div class="n-ear-r"></div><div class="n-face"></div></div>
                </div>
            </div>`;
        return wrap;
    }

    function spawnSwarm(aggressive = false) {
        const cat = createMiniNyan();
        swarmLayer.appendChild(cat);
        const startX = (Math.random() - 0.5) * width * 2;
        const startY = (Math.random() - 0.5) * height * 2;
        const startZ = -2000;
        const endX = startX * 0.5;
        const endY = startY * 0.5;
        const endZ = 1000;
        const duration = aggressive ? Math.random()*500 + 500 : Math.random()*3000 + 2000;
        const rotEnd = Math.random() * 360; 

        cat.animate([
            { transform: `translate3d(${startX}px, ${startY}px, ${startZ}px) rotateZ(0deg)`, opacity: 0 },
            { opacity: 1, offset: 0.1 },
            { transform: `translate3d(${endX}px, ${endY}px, ${endZ}px) rotateZ(${rotEnd}deg)`, opacity: 0 }
        ], { duration: duration, easing: 'linear' }).onfinish = () => cat.remove();
    }
    setInterval(() => spawnSwarm(false), 250);

    /* =========================================
       3. PARTICLE EXPLOSION
       ========================================= */
    function createExplosion(x, y) {
        const colors = ['#00f3ff', '#ff0099', '#bc13fe', '#fff'];
        for(let i=0; i<30; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            document.body.appendChild(p);
            p.style.left = x + 'px'; p.style.top = y + 'px';
            p.style.background = colors[Math.floor(Math.random()*colors.length)];
            
            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * 100 + 50;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity;
            
            p.animate([
                { transform: `translate(0,0) scale(1)`, opacity: 1 },
                { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
            ], { duration: 600, easing: 'ease-out' }).onfinish = () => p.remove();
        }
    }

    /* =========================================
       4. APP LOGIC (IMPACT SHAKE & SUCTION)
       ========================================= */
    const dz = document.getElementById('dropZone');
    const inp = document.getElementById('fileInput');
    const ws = document.getElementById('workspace');
    const list = document.getElementById('fileListDisplay');
    const status = document.getElementById('statusDisplay');
    const hiddenOutput = document.getElementById('hiddenOutput');
    const mainUI = document.getElementById('mainUI');
    const shakeLayout = document.getElementById('shake-layout');

    let currentFiles = [];
    let includeExt = false;
    let dragCounter = 0;
    let summonTimer;

    // --- IMPACT FUNCTIONS ---
    function triggerImpact() {
        shakeLayout.classList.add('effect-shake');
        mainUI.classList.add('effect-suction');
        setTimeout(() => {
            shakeLayout.classList.remove('effect-shake');
            mainUI.classList.remove('effect-suction');
        }, 500);
    }

    // --- DRAG EVENTS ---
    dz.addEventListener('dragenter', (e) => {
        e.preventDefault();
        dragCounter++;
        if (dragCounter === 1) {
            dz.classList.add('drag-active');
            targetWarpSpeed = 50; 
            
            // [NEW] START RUMBLE (Continuous Vibration)
            shakeLayout.classList.add('effect-rumble');

            // Chaos Summon
            if(!summonTimer) summonTimer = setInterval(() => spawnSwarm(true), 50);
        }
    });

    dz.addEventListener('dragleave', (e) => {
        e.preventDefault();
        dragCounter--;
        if (dragCounter <= 0) {
            dragCounter = 0;
            dz.classList.remove('drag-active');
            targetWarpSpeed = 1;
            
            // [NEW] STOP RUMBLE
            shakeLayout.classList.remove('effect-rumble');

            clearInterval(summonTimer);
            summonTimer = null;
        }
    });

    dz.addEventListener('drop', (e) => {
        e.preventDefault();
        dragCounter = 0;
        dz.classList.remove('drag-active');
        clearInterval(summonTimer);
        summonTimer = null;
        targetWarpSpeed = 1;
        
        // [NEW] STOP RUMBLE -> TRIGGER IMPACT
        shakeLayout.classList.remove('effect-rumble');
        triggerImpact();
        createExplosion(e.clientX, e.clientY);
        
        handleFiles(e.dataTransfer.files);
    });

    dz.addEventListener('dragover', (e) => e.preventDefault());
    dz.addEventListener('click', () => inp.click());
    inp.addEventListener('change', (e) => handleFiles(e.target.files));

    function handleFiles(files) {
        if (!files || !files.length) return;
        currentFiles = Array.from(files);
        render();
        // Drop Impact Speed
        targetWarpSpeed = 80; 
        setTimeout(() => targetWarpSpeed = 1, 1000);
    }

    function render() {
        if (currentFiles.length) {
            ws.classList.add('active');
            status.innerHTML = `<div class="dot" style="background:#0f0;box-shadow:0 0 10px #0f0;"></div> READY: ${currentFiles.length} FILES`;
            status.classList.add('ready');
            list.innerHTML = '';
            const names = currentFiles.map(f => {
                let n = f.name;
                if (!includeExt) n = n.substring(0, n.lastIndexOf('.')) || n;
                return n;
            });
            names.forEach(n => {
                const item = document.createElement('div');
                item.className = 'file-item';
                item.innerHTML = `<span class="f-name">üìÑ ${n}</span>`;
                list.appendChild(item);
            });
            hiddenOutput.value = names.join('\n');
        } else {
            resetUI();
        }
    }

    function toggleExt() {
        includeExt = !includeExt;
        document.getElementById('extToggle').classList.toggle('active');
        if (currentFiles.length) render();
    }

    function resetUI() {
        currentFiles = [];
        ws.classList.remove('active');
        status.classList.remove('ready');
        status.innerHTML = `<div class="dot"></div> WAITING FOR DATA...`;
        hiddenOutput.value = '';
        list.innerHTML = '';
        inp.value = '';
    }

    function clearText() {
        resetUI();
    }

    function copyText() {
        if (!hiddenOutput.value) return;
        hiddenOutput.select();
        document.execCommand('copy');
        
        const btn = document.getElementById('copyBtn');
        const old = btn.innerText;
        btn.innerText = "COPIED SUCCESSFULLY";
        btn.style.background = "#fff";
        btn.style.color = "#000";
        
        // NO SHAKE, JUST WARP SPEED
        targetWarpSpeed = 150;
        for(let i=0; i<40; i++) setTimeout(() => spawnSwarm(true), i*20);

        setTimeout(() => {
            targetWarpSpeed = 1;
            btn.innerText = old;
            btn.style.background = "";
            btn.style.color = "";
        }, 1500);
    }
</script>
</body>
</html>